<!--<h1>Grab Image from Clipboard in Python with Pillow</h1>-->
<!-- Tags: Python, Images, Pillow, Windows, Linux, Mac -->

<h2>Overview</h2>

<ul>
    <li><a href="#intro">Introduction</a></li>
    <li><a href="#install_pillow_package">Install Pillow package</a></li>
    <li><a href="#grab_image_from_clipboard">Grab image from clipboard</a></li>
    <li><a href="#save_to_disk">Save image to disk</a></li>
    <li><a href="#get_image_bytes">Get image bytes</a></li>
    <li><a href="#convert_bytes_to_html_base64_img_tag">Convert bytes to base64 HTML img tag</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#references">Reference links</a></li>
</ul>


<a name="intro"></a>
<h2>Introduction</h2>

<p>Copy and paste operations are most often associated with text, but you can also copy and paste images and other formats. This example demonstrates how to pull an image off of the system clipboard using the Pillow package in Python. It has a convenient method for pulling images from the clipboard. There are a few ways you might get an image in your clipboard. For example, if you used your Grab or Snipping Tool to capture a section of your screen, but you haven't actually saved it yet, you can CTRL-C to copy the image to your clipboard. Or, if you right click an image in a web browser and choose "Copy Image".</p>

<p>As always, refer to the Check out the <a href="https://pillow.readthedocs.io/en/5.3.x/" target="_blank">Python Pillow package documentation</a> for the most complete reference. Note this is aimed primarily at Windows. These features are only partially or completely unsupported on other platforms.</p>

<P>For text only clipboard operations, check out <a href="https://pypi.org/project/pyperclip/" target="_blank">pyperclip - Cross-platform text only Python 2&3 module</a>.</p>


<a name="install_pillow_package"></a>
<h2>Install Pillow package</h2>

<p>Install the <b>pillow</b> package using <b>pip</b> in your command line shell.</p>

<pre><code>
pip install pillow
</code></pre>



<a name="grab_image_from_clipboard"></a>
<h2>Grab image from clipboard</h2>

<p>This example demonstrates how to pull an image from the clipboard. It will store it in memory and a Pillow image object. Copy an image to your clipboard with CTRL-C before running to ensure an image is actually in your clipboard. After calling <b>grabClipboard()</b> it will clear the clipboard.</p>

<p>This uses the <b>ImageGrab</b> module. Check out the  <a href="https://pillow.readthedocs.io/en/3.0.x/reference/ImageGrab.html" target="_blank">ImageGrab documentation</a> for more details. Not only can it grab an image from the clipboard, it can actually grab directly from the screen taking full or partial screenshots!</p>

<pre><code>
# pip install pillow
from PIL import ImageGrab

img = ImageGrab.grabclipboard()
# or ImageGrab.grab() to grab the whole screen!

print(img)
# <PIL.BmpImagePlugin.DibImageFile image mode=RGB size=380x173 at 0x16A43064DA0>
</code></pre>



<a name="save_to_disk"></a>
<h2>Save image to disk</h2>

<p>This example will pull an image from your clipboard and save it as both a PNG and a JPEG.</p>

<p>If you get an error like <pre>AttributeError: 'NoneType' object has no attribute 'save'</pre> it means there was no image on the clipboard when it tried to pull. Make sure to copy an image to the system clipboard with CTRL-C or some other method.</p>

<pre><code>
from PIL import ImageGrab

img = ImageGrab.grabclipboard()
        
# Save the image to disk
img.save('paste.png', 'PNG')
img.save('paste.jpg', 'JPEG')
</code></pre>












<a name="get_image_bytes"></a>
<h2>Get image bytes</h2>

<p>You might need the raw image bytes instead of the fancy Image object that pillow has. You can get the bytes by simply using the same <b>save()</b> method used to write files. Instead of passing it a filename though, pass it an in-memory binary stream, <b>BytesIO</b> object.</p>

<p>For more information on working with bytes and binary data, check out my tutorial, <a href="/content/working-binary-data-python">Working with Binary Data in Python</a>.</p>

<pre><code>
from PIL import ImageGrab
import io

img = ImageGrab.grabclipboard()

# Store the bytes in a byte stream
img_bytes = io.BytesIO()
img.save(img_bytes, format='PNG')

print(img_bytes.getvalue())
</code></pre>




<a name="convert_bytes_to_html_base64_img_tag"></a>
<h2>Convert bytes to base64 HTML img tag</h2>

<p>If you want to create a single standalone HTML file with all the images included, it can be useful to convert an image to base64 encoding and embed it in your document. If you've only ever seen <b>img</b> tags that use the <b>src</b> attribute to link to an external file, this is what the base64 embedded version looks like:</p>

<pre><code>
<!-- Base64 image example -->
<img src="data:image/png;base64, AAAnr4nykAwk9WqzMg==" />
</code></pre>
            
    
<p>This next example demonstrates how to pull an image from the clipboard, and then convert it to base64 and print out a valid HTML img tag with the image contents embedded. Keep in mind that base64 encoded images do take up slightly more base than the binary equivalent, but they are safe to transfer over text-only mediums that do not support binary.</p>


<pre><code>
from PIL import ImageGrab
import io
import codecs

# Pull image from clibpoard
img = ImageGrab.grabclipboard()

# Get raw bytes
img_bytes = io.BytesIO()
img.save(img_bytes, format='PNG')

# Convert bytes to base64
base64_data = codecs.encode(img_bytes.getvalue(), 'base64')

# Convert base64 data to a string
base64_text = codecs.decode(base64_data, 'ascii')

# Create an HTML img tag with data embedded
html_img_tag = "<img src=\"data:image/png;base64, %s\" />" % base64_text

# Print HTML tag to console (might be long).
# You can put this img tag in to HTML and the browser
# will render the image.
print(html_img_tag)
</code></pre>









<a name="conclusion"></a>
<h2>Conclusion</h2>

<p>After reading this you should be able to pull images off of your system clipboard and save them to disk, manipulate the bytes in memory, and convert the image to base64 text.</p>



<a name="references"></a>
<h2>Reference links</h2>

<ul>
    <li><a href="https://pillow.readthedocs.io/en/5.3.x/" target="_blank">Python Pillow package documentation</a></li>
    <li><a href="https://pypi.org/project/pyperclip/" target="_blank">pyperclip - Cross-platform text only Python 2&3 module</a></li>
    <li><a href="https://pillow.readthedocs.io/en/3.0.x/reference/ImageGrab.html" target="_blank">ImageGrab documentation</a></li>
</ul>