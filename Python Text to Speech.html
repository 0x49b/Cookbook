<!--<h1>Text-to-speech in Python with pyttsx3</h1>-->
<!-- Tags: Python, Linux, Windows, Mac, Text-to-speech -->

<h2>Overview</h2>

<ul>
    <li><a href="#intro">Introduction</a></li>
    <li><a href="#install_package">Install the package</a></li>
    <li><a href="#convert_text_to_speech">Convert text to speech</a></li>
    <li><a href="#change_voice_language">Change voice and Language</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#references">Reference links</a></li>
</ul>


<a name="intro"></a>
<h2>Introduction</h2>

<p>This tutorials demonstrates how to use Python for text-to-speech using a cross-platform library, <b>pyttsx3</b>. This lets you synthesize text in to audio you can hear. This package works in Windows, Mac, and Linux. It uses native speech drivers when available and works completely offline.</p>

<p>There are some other cool features that are not covered here, like the event system. You can hook in to the engine on certain events. You can use this to count how many words are said and cut it off if it has received input that is too long. You can inspect each word and cut it off if there are inappropriate words. The event hooks are not covered here but are worth a mention. Check the <a href="https://pyttsx3.readthedocs.io/en/latest/engine.html#examples" target="_blank">official examples</a> to see how this is done.</p>

<p>Always refer to the <a href="https://pyttsx3.readthedocs.io/en/latest/" target="_blank">official documentation</a> for the most accurate, complete, and up-to-date information. This is only meant to serve as a primer.</p>

<p>The <b>pyttsx3</b> module supports native Windows and Mac speech APIs but also supports espeak, making it the best available text-to-speech package in my opinion. If you are interested specifically and only in speak, you might be interested in my <a href="/content/text-speech-python-espeak">Python text-to-speech with espeak tutorial</a>.</p>



<a name="install_package"></a>
<h2>Install the package</h2>

<p>Use <b>pip</b> to install the package. If you are in Windows, you will need an additional package, <b>pypiwin32</b> which it will need to access the native Windows speech API.</p>

<pre><code>
pip install pyttsx3
pip install pypiwin32  # Windows only
</code></pre>


<a name="convert_text_to_speech"></a>
<h2>Convert text to speech</h2>

<pre><code>
# pip install pyttsx3 pypiwin32
import pyttsx3

# One time initialization
engine = pyttsx3.init()

# Set properties _before_ you add things to say
engine.setProperty('rate', 150)    # Speed percent (can go over 100)
engine.setProperty('volume', 0.9)  # Volume 0-1

# Queue up things to say.
# There will be a short break between each one
# when spoken, like a pause between sentences.
engine.say("You've got mail!")
engine.say("You can queue up multiple items")

# Flush the say() queue and play the audio
engine.runAndWait()

# Program will not continue execution until
# all speech is done talking
</code></pre>


<a name="change_voice_language"></a>
<h2>Change voice and language</h2>

<p>The voices available will depend on what your system has installed. You can get a list of available voices on your machine by pulling the <b>voices</b> property from the engine. Note that the voices you have available on your computer might be different from someone else's machine. There is a default voice set so you are not required to pick a voice. This is only if you want to change it from the default.</p>

<p>In Windows, you can learn more about installing other languages with this Microsoft support article, <a href="https://support.office.com/en-us/article/how-to-download-text-to-speech-languages-for-windows-10-d5a6b612-b3ae-423f-afa5-4f6caf1ec5d3" target="_blank">How to download Text-to-Speech languages for Windows 10</a>. It also covers how to install espeak open source languages.</p>
  
    
<p>You can get a list of available voices like this:</p>

<pre><code>
# Print all available voices
import pyttsx3
engine = pyttsx3.init()

voices = engine.getProperty('voices')
for voice in voices:
    print("Voice:")
    print(" - ID: %s" % voice.id)
    print(" - Name: %s" % voice.name)
    print(" - Languages: %s" % voice.languages)
    print(" - Gender: %s" % voice.gender)
    print(" - Age: %s" % voice.age)
</code></pre>

<p>Example output from my Windows 10 machine with three voices available.</p>

<pre>
Voice:
- ID: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens\TTS_MS_EN-US_DAVID_11.0
- Name: Microsoft David Desktop - English (United States)
- Languages: []
- Gender: None
- Age: None
Voice:
- ID: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens\TTS_MS_EN-US_ZIRA_11.0
- Name: Microsoft Zira Desktop - English (United States)
- Languages: []
- Gender: None
- Age: None
Voice:
 - ID: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens\TTS_MS_RU-RU_IRINA_11.0
 - Name: Microsoft Irina Desktop - Russian
 - Languages: []
 - Gender: None
 - Age: None
</pre>

<p>Set the voice you want to use with the <b>setProperty()</b> method on the engine. For example, using voice IDs found earlier, this is how you would set the voice. This example shows how to set one voice to say soemthing, and then use a different voice from a different language to say something else.</p>


<pre><code>
import pyttsx3
engine = pyttsx3.init()

# Voice IDs pulled from engine.getProperty('voices')
# These will be system specific
en_voice_id = "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens\TTS_MS_EN-US_ZIRA_11.0"
ru_voice_id = "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens\TTS_MS_RU-RU_IRINA_11.0"

# Use female English voice
engine.setProperty('voice', en_voice_id)
engine.say('Hello with my new voice')

# Use female Russian voice
engine.setProperty('voice', ru_voice_id)
engine.say('Привет. где хакер')

engine.runAndWait()
</code></pre>




<a name="conclusion"></a>
<h2>Conclusion</h2>

<p>After reading this you should feel comfortable using Python for basic text-to-speech applications on all major platforms. What uses can you think of?</p>



<a name="references"></a>
<h2>Reference links</h2>

<ul>
    <li><a href="https://pypi.org/project/pyttsx3/" target="_blank">pyttsx3 module onn Pypi</a></li>
    <li><a href="https://pypi.org/project/pypiwin32/" target="_blank">pypiwin32 module on Pypi</a></li>
    <li><a href="https://github.com/nateshmbhat/pyttsx3" target="_blank">pyttsx3 source code</a></li>
    <li><a href="https://pyttsx3.readthedocs.io/en/latest/" target="_blank">pyttsx3 documentation</a></li>
    <li><a href="https://pyttsx3.readthedocs.io/en/latest/engine.html#examples" target="_blank">Official examples</a></li>
    <li><a href="https://support.office.com/en-us/article/how-to-download-text-to-speech-languages-for-windows-10-d5a6b612-b3ae-423f-afa5-4f6caf1ec5d3" target="_blank">How to download Text-to-Speech languages for Windows 10</a></li>
    <li><a href="/content/text-speech-python-espeak">Python text-to-speech with espeak tutorial</a></li>
</ul>