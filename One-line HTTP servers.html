<!--<h1>One-line HTTP servers</h1>-->
<!-- Tags: sysadmin, HTTP, nginx, openssl, letsencrypt, python, ruby, jruby, php, tomcat -->

<h2>Overview</h2>

<ul>
    <li><a href="#intro">Intro</a></li>
    <li><a href="#quick_examples">Quick examples</a></li>
    <li><a href="#python3">Python 3</a></li>
    <li><a href="#python2">Python 2</a></li>
    <li><a href="#php">PHP</a></li>
    <li><a href="#ruby">Ruby/JRuby</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
</ul>


<a name="intro"></a>
<h2>Intro</h2>

<p>If you need a quick-and-dirty HTTP server that doesn't need fancy configuration, try some of these one-line HTTP servers in languages like Python, Ruby, and PHP. Some examples include a small script that allows you to embed the server in to your program and add more customization. These are <b>not intended for production use</b>. </p>

<p>These examples are good for:</p>

<ul>
    <li>Temporary test servers</li>
    <li>Development of web apps</li>
    <li>Quickly sharing or moving files over HTTP</li>
    <li>Testing reverse proxies</li>
</ul>

<p>These servers do not take security in to consideration. Most of them will serve your current directory, unencrypted, with a directory listing, on all public interfaces (0.0.0.0). That means with the default settings they will publicly serve up all your information in plain-text. Examples are provided whenever possible on how to specify the bind interface and port to prevent exposing data publicly. Be aware of the risks when using these.</p>

<p>If you want to setup a production server, I recommend Apache httpd or nginx. I have an <a href="/content/nginx-tutorial">Nginx tutorial</a> that covers installation, usage, and basic configuration options.</p>
    
<!--
<p>For Java/JRuby users, check out my [[Tomcat server tutorial]].</p>
-->

<p>Production servers should also use encryption (SSL). Check out my <a href="/content/creating-self-signed-ssl-certificates-openssl">OpenSSL self-signed certificate tutorial</a> and my <a href="/content/letsencrypt-free-ssl-certificate-tutorial">Let's Encrypt SSL certificate tutorial</a> for instructions on how to obtain SSL certificates and use them with a production quality web server like Apache httpd or nginx.</p>






<a name="quick_examples"></a>
<h2>Quick examples</h2>

<p>Run these in the shell or command prompt. They will serve the current directory, usually with a directory listing if an index.html is not present. The default ports vary but are typically 8000 for Python or 8080 for Ruby. Most listen on 0.0.0.0.</p>

<pre><code>
    python3 -m http.server
    python2 -m SimpleHTTPServer
    php -S 0.0.0.0:8000
    ruby -run -e httpd
</code></pre>






<a name="python3"></a>
<h2>Python 3</h2>

<p>The Python 3 standard library comes with the <b>http.server</b> module. You can invoke the module directly with Python using a single command or you can use the HTTP server within your own Python application. Both examples are demonstrated below. For more information about http.server check out the official documentation at <a href="https://docs.python.org/3/library/http.server.html" target="_blank">https://docs.python.org/3/library/http.server.html</a>.</p>

<pre><code>
# Default listen: 0.0.0.0:8000
# Provides directory listing if no index.html present
python3 -m http.server

# Specify listen host and port information
python3 -m http.server --bind 0.0.0.0 9999

# In 3.7+ you can specify directory too
python3 -m http.server --directory /path/to/serve
</code></pre>

<p>To use the http.server in your own program, you can import the http.server and socketserver modules. The handler is a class that takes the incoming TCP data and processes it like an HTTP request. It implements do_GET() and do_POST() methods for example. Python comes with the SimpleHTTPRequestHandler that is used here.</p>

<pre><code>
# https://docs.python.org/3/library/http.server.html
import http.server
import socketserver

Handler = http.server.SimpleHTTPRequestHandler
with socketserver.TCPServer(("0.0.0.0", 9999), Handler) as httpd:
    httpd.serve_forever()
</code></pre>






<a name="python2"></a>
<h2>Python 2</h2>

<p>The Python 2 standard library comes with the <b>SimpleHTTPServer</b> module. You can invoke the module directly with Python using a single command or you can use the HTTP server within your own Python application. Both examples are demonstrated below. Read more at <a href="https://docs.python.org/2/library/simplehttpserver.html" target="_blank">https://docs.python.org/2/library/simplehttpserver.html</a>.</p>

<pre><code>
# Default listen: 0.0.0.0:8000
# Provides directory listing if no index.html present
python2 -m SimpleHTTPServer

# Specify port, but can't change the 0.0.0.0 bind or directory
python2 -m SimpleHTTPServer 8888
</code></pre>

<p>To embed the HTTP server inside your own Python 2 application, use the example below.</p>

<pre><code>
# https://docs.python.org/2/library/simplehttpserver.html
import SimpleHTTPServer
import SocketServer

Handler = SimpleHTTPServer.SimpleHTTPRequestHandler
httpd = SocketServer.TCPServer(("0.0.0.0", 9999), Handler)
httpd.serve_forever()
</code></pre>






<a name="php"></a>
<h2>PHP</h2>

<p>The PHP server will serve static files just fine, but it will also process PHP scripts allowing you to create dynamic pages that execute code when they are visited in the browser. The PHP built-in server has a few more features and configuration than the simple Python servers, but it is still not intended for production use.</p>

<pre><code>
# Serves current directory, no directory listing
php -S localhost:9999

# Specify path to serve
php -S localhost:9999 -t /path/to/serve

# Print full usage/help info
php -S
</code></pre>







<a name="ruby"></a>
<h2>Ruby</h2>

<p>Ruby comes with the WEBrick module as part of the sandard library. It is an HTTP server that has quite a few configurable features. It is probably the most configurable and useful out of all the language examples provided so far. The documentation for WEBrick can be found in the standard library documentation. For example, the current latest version is available at <a href="https://ruby-doc.org/stdlib-2.5.1/libdoc/webrick/rdoc/WEBrick.html" target="_blnak">https://ruby-doc.org/stdlib-2.5.1/libdoc/webrick/rdoc/WEBrick.html</a>.</p>

<p>This also works with <a href="https://www.jruby.org/" target="_blank">JRuby</a> if you are in a Java environment. Just replace <b>ruby</b> with <b>jruby</b>. Since WEBrick is part of the standard library, it should work out-of-the-box with JRuby.</p>

<p>WEBrick even has the concept of <a href="https://ruby-doc.org/stdlib-2.5.1/libdoc/webrick/rdoc/WEBrick.html#module-WEBrick-label-Servlets
" target="_blank">servlets</a> like in Java. It also supports <a href="https://ruby-doc.org/stdlib-2.5.1/libdoc/webrick/rdoc/WEBrick.html#module-WEBrick-label-Virtual+Hosts" target="_blank">virtual hosts</a> and even <a href="https://ruby-doc.org/stdlib-2.5.1/libdoc/webrick/rdoc/WEBrick/HTTPAuth/BasicAuth.html" target="_blank">authentication</a>, like http basic auth. Those are out of the scope here but worth mentioning how many features WEBrick has compared to all the other examples. WEBrick also supports SSL but that's not going to be covered here.</p>

<pre><code>
# Defaults to 0.0.0.0:8080
# Serves current directory
# Provides directory listing if no index.html
ruby -run -e httpd

# Specify port and directory to serve
ruby -run -e httpd /path/to/serve -p 9999
</code></pre>


<p>To use the WEBrick server within your own Ruby application, you need to require the webrick module, instantiate a new HTTPServer, and then call start. Optionally you can capture the interrupt signal (SIGINT) that is sent when a user presses CTRL-C to make it easy to kill the process from the command line.</p>


<pre><code>
require 'webrick'

server = WEBrick::HTTPServer.new(
    :Port => 9999,
    :DocumentRoot => Dir.pwd
)

# Trigger server to stop on CTRL-C (SIGINT interrupt)
# Without this, CTRL-C still works, but 
# you get an unclean shutdown
trap('INT') { server.stop }

server.start
</code></pre>

<p>You could technically squish it all on to a single line. The -r requires the webrick module and the -e tells Ruby to execute the string provided (the code).</p>

<pre><code>
ruby -r webrick -e "server = WEBrick::HTTPServer.new(:Port => 9999, :DocumentRoot => Dir.pwd); trap('INT') { s.shutdown }; server.start"
</code></pre>





<a name="conclusion"></a>
<h2>Conclusion</h2>

<p>If you've read everything, you should be able to run simple HTTP servers that serve a directory. You should also understand how some examples will serve index.html files while others will serve a directory listings or both. Before using them you should understand how binding to localhost is different from binding to 0.0.0.0 and understand there is no SSL or encryption in these servers. These examples are not intended for production use and are for development and convenient purposes. Use the one-line commands for quick testing and hosting or use the built-in libraries to add an HTTP server to your own application.</p>

